<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ERIS CORE: functions</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ERIS CORE
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('de/dc4/md__e_r_i_s_core_lib_wren_doc_site_functions.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">functions </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>^title Functions</p>
<p>Like many languages today, functions in Wren are little bundles of code you can store in a variable, or pass as an argument to a method.</p>
<p>Notice there's a difference between <em>function</em> and <em>method</em>.</p>
<p>Since Wren is object-oriented, most of your code will live in methods on classes, but free-floating functions are still eminently handy.</p>
<p>Functions are objects like everything else in Wren, instances of the <code>Fn</code> class.</p>
<h2><a class="anchor" id="autotoc_md280"></a>
Creating a function</h2>
<p>To create a function, we call <code>Fn.new</code>, which takes a block to execute. To call the function, we use <code>.<a class="el" href="../../d4/de2/wren__compiler_8c.html#abc28d53c9cefc405f7f74cd877d037d1">call()</a></code> on the function instance.</p>
<pre class="snippet">
var sayHello = Fn.new { System.print("hello") }

sayHello.call() //&gt; hello
</pre><p>Note that we'll see a shorthand syntax for creating a function below.</p>
<h2><a class="anchor" id="autotoc_md282"></a>
Function parameters</h2>
<p>Of course, functions aren't very useful if you can't pass values to them. The function above takes no arguments. To change that, you can provide a parameter list surrounded by <code>|</code> immediately after the opening brace of the body.</p>
<p>To pass arguments to the function, pass them to the <code>call</code> method:</p>
<pre class="snippet">
var sayMessage = Fn.new {|recipient, message|
  System.print("message for %(recipient): %(message)")
}

sayMessage.call("Bob", "Good day!")
</pre><p>It's an error to call a function with fewer arguments than its parameter list expects. If you pass too <em>many</em> arguments, the extras are ignored.</p>
<h2><a class="anchor" id="autotoc_md285"></a>
Returning values</h2>
<p>The body of a function is a <a href="../../syntax.html#blocks">block</a>. If it is a single expression&mdash;more precisely if there is no newline after the <code>{</code> or parameter list&mdash;then the function implicitly returns the value of the expression.</p>
<p>Otherwise, the body returns <code>null</code> by default. You can explicitly return a value using a <code>return</code> statement. In other words, these two functions do the same thing:</p>
<pre class="snippet">
Fn.new { "return value" }

Fn.new {
  return "return value"
}
</pre><p>The return value is handed back to you when using <code>call</code>:</p>
<pre class="snippet">
var fn = Fn.new { "some value" }
var result = fn.call()
System.print(result) //&gt; some value
</pre><h2><a class="anchor" id="autotoc_md286"></a>
Closures</h2>
<p>As you expect, functions are closures&mdash;they can access variables defined outside of their scope. They will hold onto closed-over variables even after leaving the scope where the function is defined:</p>
<pre class="snippet">
class Counter {
  static create() {
    var i = 0
    return Fn.new { i = i + 1 }
  }
}
</pre><p>Here, the <code>create</code> method returns the function created on its second line. That function references a variable <code>i</code> declared outside of the function. Even after the function is returned from <code>create</code>, it is still able to read and assign to<code>i</code>:</p>
<pre class="snippet">
var counter = Counter.create()
System.print(counter.call()) //&gt; 1
System.print(counter.call()) //&gt; 2
System.print(counter.call()) //&gt; 3
</pre><h2><a class="anchor" id="autotoc_md287"></a>
Callable classes</h2>
<p>Because <code>Fn</code> is a class, and responds to <code><a class="el" href="../../d4/de2/wren__compiler_8c.html#abc28d53c9cefc405f7f74cd877d037d1">call()</a></code>, any class can respond to <code><a class="el" href="../../d4/de2/wren__compiler_8c.html#abc28d53c9cefc405f7f74cd877d037d1">call()</a></code> and be used in place of a function. This is particularly handy when the function is passed to a method to be called, like a callback or event.</p>
<pre class="snippet">
class Callable {
  construct new() {}
  call(name, version) {
    System.print("called %(name) with version %(version)")
  }
}

var fn = Callable.new()
fn.call("wren", "0.4.0")
</pre><h2><a class="anchor" id="autotoc_md288"></a>
Block arguments</h2>
<p>Very frequently, functions are passed to methods to be called. There are countless examples of this in Wren, like <a href="../../lists.html">list</a> can be filtered using a method <code>where</code> which accepts a function:</p>
<pre class="snippet">
var list = [1, 2, 3, 4, 5]
var filtered = list.where(Fn.new {|value| value &gt; 3 }) 
System.print(filtered.toList) //&gt; [4, 5]
</pre><p>This syntax is a bit less fun to read and write, so Wren implements the <em>block argument</em> concept. When a function is being passed to a method, and is the last argument to the method, it can use a shorter syntax: <em>just the block part</em>.</p>
<p>Let's use a block argument for <code>list.where</code>, it's the last (only) argument:</p>
<pre class="snippet">
var list = [1, 2, 3, 4, 5]
var filtered = list.where {|value| value &gt; 3 } 
System.print(filtered.toList) //&gt; [4, 5]
</pre><p>We've seen this before in a previous page using <code>map</code> and <code>where</code>:</p>
<pre class="snippet">
numbers.map {|n| n * 2 }.where {|n| n &lt; 100 }
</pre><h2><a class="anchor" id="autotoc_md289"></a>
Block argument example</h2>
<p>Let's look at a complete example, so we can see both ends.</p>
<p>Here's a fictional class for something that will call a function when a click event is sent to it. It allows us to pass just a function and assume the left mouse button, or to pass a button and a function.</p>
<pre class="snippet">
class Clickable {
  construct new() {
    _fn = null
    _button = 0
  }

  onClick(fn) {
    _fn = fn
  }

  onClick(button, fn) {
    _button = button
    _fn = fn
  }

  fireEvent(button) {
    if(_fn &amp;&amp; button == _button) {
      _fn.call(button)
    }
  }
}
</pre><p>Now that we've got the clickable class, let's use it. We'll start by using the method that accepts just a function because we're fine with it just being the default left mouse button.</p>
<pre class="snippet">
var link = Clickable.new()

link.onClick {|button|
  System.print("I was clicked by button %(button)")
}

// send a left mouse click
// normally this would happen from elsewhere

link.fireEvent(0)  //&gt; I was clicked by button 0
</pre><p>Now let's try with the extra button argument:</p>
<pre class="snippet">
var contextMenu = Clickable.new()

contextMenu.onClick(1) {|button|
  System.print("I was right-clicked")
}

link.fireEvent(0)  //&gt; (nothing happened)
link.fireEvent(1)  //&gt; I was right-clicked
</pre><p>Notice that we still pass the other arguments normally, it's only the last argument that is special.</p>
<p><b>Just a regular function</b> <br  />
</p>
<p>Block arguments are purely syntax sugar for creating a function and passing it in one little blob of syntax. These two are equivalent:</p>
<pre class="snippet">
onClick(Fn.new { System.print("clicked") })
onClick { System.print("clicked") }
</pre><p>And this is just as valid:</p>
<pre class="snippet">
var onEvent = Fn.new {|button|
  System.print("clicked by button %(button)")
}

onClick(onEvent)
onClick(1, onEvent)
</pre><p><b>Fn.new</b> <br  />
 As you may have noticed by now, <code>Fn</code> accepts a block argument for the <code>Fn.new</code>. All the constructor does is return that argument right back to you!</p>
<p><br  />
</p><hr  />
<p> <a href="../../classes.html" class="right">Classes &rarr;</a> <a href="../../variables.html">&larr; Variables</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
