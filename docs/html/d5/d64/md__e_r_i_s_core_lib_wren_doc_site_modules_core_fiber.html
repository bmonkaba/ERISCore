<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ERIS CORE: fiber</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ERIS CORE
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d5/d64/md__e_r_i_s_core_lib_wren_doc_site_modules_core_fiber.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">fiber </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>^title Fiber Class</p>
<p>A lightweight coroutine. <a href="../../../../concurrency.html">Here</a> is a gentle introduction.</p>
<h2><a class="anchor" id="autotoc_md266"></a>
Static Methods</h2>
<h3><a class="anchor" id="autotoc_md267"></a>
Fiber.**abort**(message)</h3>
<p>Raises a runtime error with the provided message:</p>
<pre class="snippet">
Fiber.abort("Something bad happened.")
</pre><p>If the message is <code>null</code>, does nothing.</p>
<h3><a class="anchor" id="autotoc_md268"></a>
Fiber.**current**</h3>
<p>The currently executing fiber.</p>
<h3><a class="anchor" id="autotoc_md269"></a>
Fiber.**new**(function)</h3>
<p>Creates a new fiber that executes <code>function</code> in a separate coroutine when the fiber is run. Does not immediately start running the fiber.</p>
<pre class="snippet">
var fiber = Fiber.new {
  System.print("I won't get printed")
}
</pre><p><code>function</code> must be a function (an actual <a href="../../fn.html">Fn</a> instance, not just an object with a <code><a class="el" href="../../d4/de2/wren__compiler_8c.html#abc28d53c9cefc405f7f74cd877d037d1">call()</a></code> method) and it may only take zero or one parameters.</p>
<h3><a class="anchor" id="autotoc_md270"></a>
Fiber.**suspend**()</h3>
<p>Pauses the current fiber, and stops the interpreter. Control returns to the host application.</p>
<p>Typically, you store a reference to the fiber using <code>Fiber.current</code> before calling this. The fiber can be resumed later by calling or transferring to that reference. If there are no references to it, it is eventually garbage collected.</p>
<p>Much like <code>yield()</code>, returns the value passed to <code><a class="el" href="../../d4/de2/wren__compiler_8c.html#abc28d53c9cefc405f7f74cd877d037d1">call()</a></code> or <code>transfer()</code> when the fiber is resumed.</p>
<h3><a class="anchor" id="autotoc_md271"></a>
Fiber.**yield**()</h3>
<p>Pauses the current fiber and transfers control to the parent fiber. "Parent" here means the last fiber that was started using <code>call</code> and not <code>transfer</code>.</p>
<pre class="snippet">
var fiber = Fiber.new {
  System.print("Before yield")
  Fiber.yield()
  System.print("After yield")
}

fiber.call()                //&gt; Before yield
System.print("After call")  //&gt; After call
fiber.call()                //&gt; After yield
</pre><p>When resumed, the parent fiber's <code><a class="el" href="../../d4/de2/wren__compiler_8c.html#abc28d53c9cefc405f7f74cd877d037d1">call()</a></code> method returns <code>null</code>.</p>
<p>If a yielded fiber is resumed by calling <code><a class="el" href="../../d4/de2/wren__compiler_8c.html#abc28d53c9cefc405f7f74cd877d037d1">call()</a></code> or <code>transfer()</code> with an argument, <code>yield()</code> returns that value.</p>
<pre class="snippet">
var fiber = Fiber.new {
  System.print(Fiber.yield()) //&gt; value
}

fiber.call()        // Run until the first yield.
fiber.call("value") // Resume the fiber.
</pre><p>If it was resumed by calling <code><a class="el" href="../../d4/de2/wren__compiler_8c.html#abc28d53c9cefc405f7f74cd877d037d1">call()</a></code> or <code>transfer()</code> with no argument, it returns <code>null</code>.</p>
<p>If there is no parent fiber to return to, this exits the interpreter. This can be useful to pause execution until the host application wants to resume it later.</p>
<pre class="snippet">
Fiber.yield()
System.print("this does not get reached")
</pre><h3><a class="anchor" id="autotoc_md272"></a>
Fiber.**yield**(value)</h3>
<p>Similar to <code>Fiber.yield</code> but provides a value to return to the parent fiber's <code>call</code>.</p>
<pre class="snippet">
var fiber = Fiber.new {
  Fiber.yield("value")
}

System.print(fiber.call()) //&gt; value
</pre><h2><a class="anchor" id="autotoc_md273"></a>
Methods</h2>
<h3><a class="anchor" id="autotoc_md274"></a>
&lt;strong&gt;call&lt;/strong&gt;()</h3>
<p>Starts or resumes the fiber if it is in a paused state. Equivalent to:</p>
<pre class="snippet">
fiber.call(null)
</pre><h3><a class="anchor" id="autotoc_md275"></a>
&lt;strong&gt;call&lt;/strong&gt;(value)</h3>
<p>Start or resumes the fiber if it is in a paused state. If the fiber is being started for the first time, and its function takes a parameter, <code>value</code> is passed to it.</p>
<pre class="snippet">
var fiber = Fiber.new {|param|
  System.print(param) //&gt; begin
}

fiber.call("begin")
</pre><p>If the fiber is being resumed, <code>value</code> becomes the returned value of the fiber's call to <code>yield</code>.</p>
<pre class="snippet">
var fiber = Fiber.new {
  System.print(Fiber.yield()) //&gt; resume
}

fiber.call()
fiber.call("resume")
</pre><h3><a class="anchor" id="autotoc_md276"></a>
&lt;strong&gt;error&lt;/strong&gt;</h3>
<p>The error message that was passed when aborting the fiber, or <code>null</code> if the fiber has not been aborted.</p>
<pre class="snippet">
var fiber = Fiber.new {
  123.badMethod
}

fiber.try()
System.print(fiber.error) //&gt; Num does not implement method 'badMethod'.
</pre><h3><a class="anchor" id="autotoc_md277"></a>
&lt;strong&gt;isDone&lt;/strong&gt;</h3>
<p>Whether the fiber's main function has completed and the fiber can no longer be run. This returns <code>false</code> if the fiber is currently running or has yielded.</p>
<h3><a class="anchor" id="autotoc_md278"></a>
&lt;strong&gt;try&lt;/strong&gt;()</h3>
<p>Tries to run the fiber. If a runtime error occurs in the called fiber, the error is captured and is returned as a string.</p>
<pre class="snippet">
var fiber = Fiber.new {
  123.badMethod
}

var error = fiber.try()
System.print("Caught error: " + error)
</pre><p>If the called fiber raises an error, it can no longer be used.</p>
<h3><a class="anchor" id="autotoc_md279"></a>
&lt;strong&gt;try&lt;/strong&gt;(value)</h3>
<p>Tries to run the fiber. If a runtime error occurs in the called fiber, the error is captured and is returned as a string. If the fiber is being started for the first time, and its function takes a parameter, <code>value</code> is passed to it.</p>
<pre class="snippet">
var fiber = Fiber.new {|value|
  value.badMethod
}

var error = fiber.try("just a string")
System.print("Caught error: " + error)
</pre><p>If the called fiber raises an error, it can no longer be used.</p>
<h3><a class="anchor" id="autotoc_md281"></a>
&lt;strong&gt;transfer&lt;/strong&gt;()</h3>
<p>Pauses execution of the current running fiber, and transfers control to this fiber.</p>
<p><a href="../../../../concurrency.html#transferring-control">Read more</a> about the difference between <code>call</code> and <code>transfer</code>. Unlike <code>call</code>, <code>transfer</code> doesn't track the origin of the transfer.</p>
<pre class="snippet">
// keep hold of the fiber we start in
var main = Fiber.current

// create a new fiber, note it doesn't execute yet!
var fiber = Fiber.new {
  System.print("inside 'fiber'") //&gt; #2: from #1
  main.transfer()                //&gt; #3: go back to 'main'
}

fiber.transfer()      //&gt; #1: print "inside 'fiber'" via #2
                      //&gt; this fiber is now paused by #1

System.print("main")  //&gt; #4: prints "main", unpaused by #3
</pre><h3><a class="anchor" id="autotoc_md283"></a>
&lt;strong&gt;transfer&lt;/strong&gt;(value)</h3>
<p>Pauses execution of the current running fiber, and transfers control to this fiber.</p>
<p>Similar to <code>transfer</code>, but a value can be passed between the fibers.</p>
<pre class="snippet">
// keep hold of the fiber we start in
var main = Fiber.current

// create a new fiber, note it doesn't execute yet
// also note that we're accepting a 'value' parameter
var fiber = Fiber.new {|value|
  System.print("in 'fiber' = %(value)")   //&gt; #2: in 'fiber' = 5
  var result = main.transfer("hello?")    //&gt; #3: send to 'message'
  System.print("end 'fiber' = %(result)") //&gt; #6: end 'fiber' = 32
}

var message = fiber.transfer(5)   //&gt; #1: send to 'value'
System.print("... %(message)")    //&gt; #4: ... hello?
fiber.transfer(32)                //&gt; #5: send to 'result'
</pre><h3><a class="anchor" id="autotoc_md284"></a>
&lt;strong&gt;transferError&lt;/strong&gt;(error)</h3>
<p>Transfer to this fiber, but set this fiber into an error state. The <code>fiber.error</code> value will be populated with the value in <code>error</code>.</p>
<pre class="snippet">
var A = Fiber.new {
  System.print("transferred to A")     //&gt; #4
  B.transferError("error!")            //&gt; #5
}

var B = Fiber.new {
  System.print("started B")            //&gt; #2 
  A.transfer()                         //&gt; #3
  System.print("should not get here")
}

B.try()                   //&gt; #1
System.print(B.error)     //&gt; #6: prints "error!" from #5

// B fiber can no longer be used

B.call()                  //&gt; #7: Cannot call an aborted fiber.
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
